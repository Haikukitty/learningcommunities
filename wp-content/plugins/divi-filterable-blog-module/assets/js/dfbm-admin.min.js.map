{"version":3,"sources":["dfbm-admin.js"],"names":["$","dfbmAdmin","$opt","this","init","extend","prototype","_defineProperty","vars","load","opt","prefix","prfix","newVers","error","slugs","RegExp","parseInt","$this","checkStorage","setInterval","localStorage","et_pb_templates_settings_product_version","clearInterval","setTimeout","rebuild","check","local","item","temp","mods","indexOf","push","length","window","clear","pref","get","filter","ajax","type","dataType","url","et_pb_options","ajaxurl","data","action","et_post_type","post_type","et_admin_load_nonce","et_modules_slugs","JSON","stringify","missing_modules_array","success","templates","each","i","template","unique","setItem","LZString","compressToUTF16","e","remove","append","r","console","log","_template","map","str","replace","match","key","removeItem","alert","dfbmPHP","new","jQuery"],"mappings":"oJAAC,SAASA,GACTA,EAAE,WAGD,GAAIC,GAAY,QAAZA,GAAsBC,GAGzBC,KAAKC,KAAMF,GAIZF,GAAEK,OAAQJ,EAAUK,UAApBC,iBAGCH,KAAO,QAAAA,GAAUF,GAGhBC,KAAKK,KAAMN,GAEXC,KAAKM,QAIND,KAAO,QAAAA,GAAUN,GAGhBC,KAAKO,IAAMV,EAAEK,WAGZM,OAAU,mBACVC,MAAU,GACVC,QAAU,GACVC,MAAU,GACVC,MAAU,IAERb,GAEHC,KAAKS,MAAU,GAAII,QAAQb,KAAKO,IAAIE,OAEpCT,KAAKU,QAAUI,SAAUd,KAAKO,IAAIG,UAInCJ,KAAO,QAAAA,KAGN,GAAIS,GAAQf,KAAMgB,EAAeC,YAAa,WAGxC,gBAAmBC,cAAaC,2CAGpCC,cAAeJ,GAEfK,WAAY,WAGNN,EAAML,QACVK,EAAMO,SAAS,GAEXP,EAAMQ,SAET,OAEF,MAGJA,MAAQ,QAAAA,KAGP,GAAOvB,KAAKwB,QAAZ,CAGA,GAAIC,GAAMC,EAAMC,IAEhB,KAAMF,IAAQP,eAGP,IAAMO,EAAKG,QAAS5B,KAAKS,QAG9BkB,EAAKE,KAAMJ,EAKRE,GAAKG,QAAU9B,KAAKO,IAAIK,MAAMkB,QAClC9B,KAAKsB,SAAS,EAAMK,KAItBH,MAAQ,QAAAA,KAGP,MAAO,gBAAkBO,SAAkC,OAAxBA,OAAOb,cAI3CI,QAAU,QAAAA,GAAUU,EAAOL,GAG1B,GAAIZ,GAAQf,KACX2B,EAAQA,IAAQ,EAChBM,EAAQ,kBAKT,IAHOD,GACNhC,KAAKgC,QAEDL,EACJ,GAAIO,GAAMlC,KAAKO,IAAIK,MAAMuB,OAAQ,SAAUV,GAG1C,MAAOE,GAAKC,QAASK,EAAOR,GAAS,QAKtCS,GAAMlC,KAAKO,IAAIK,KAEhBf,GAAEuC,MAGDC,KAAW,OACXC,SAAW,OACXC,IAAWC,cAAcC,QACzBC,MAGCC,OAAsB,8BACtBC,aAAsBJ,cAAcK,UACpCC,oBAAsBN,cAAcM,oBACpCC,iBAAsBC,KAAKC,WAAYC,sBAAuBhB,KAG/DiB,QAAS,QAAAA,GAAUT,OAGb,KAAsBA,EAAKU,WAAaV,EAAKU,UAAUtB,OAAS,GAGpEjC,EAAEwD,KAAMX,EAAKU,UAAW,SAAUE,EAAG7B,GAGpC,GAAI8B,GAAWxC,EAAMwC,SAAU9B,EAAA,SAAkBiB,EAAKc,OAEtD,IAAKzC,EAAMS,QAGV,IAGCN,aAAauC,QAASxB,EAAOR,EAAA,KAAciC,SAASC,gBAAiBJ,IAItE,MAAMK,IAQP/D,EAAG,eAAiB4B,EAAA,KAAe,oBAAqBoC,SAExDhE,EAAG,QAASiE,OAAQP,MAMvB5C,MAAO,QAAAA,GAAUoD,GAGhBC,QAAQC,IAAKF,OAMhBR,SAAW,QAAAA,GAAUW,EAAUC,GAG9B,OAAK,KAAsBA,EAC1B,MAAOD,EAER,IAAIE,GAAM,iBAEV,OAAOF,GAASG,QAASD,EAAK,SAAUE,EAAOC,GAG9C,MAAOJ,GAAII,MAKbvC,MAAQ,QAAAA,KAGP,IAAM,GAAIP,KAAQP,eAGX,IAAMO,EAAKG,QAAS5B,KAAKS,QAC9BS,aAAasD,WAAY/C,IAK5Bd,MAAQ,QAAAA,KAGPX,KAAKgC,QAELyC,MAAOzE,KAAKO,IAAII,SA1MlB,QA8MS,QAAAa,KAGP,MAAO,gBAAkBO,SAAkC,OAAxBA,OAAOb,gBAK5C,GAAIpB,IAGHW,MAAUiE,QAAQjE,MAClBC,QAAUgE,QAAQC,IAClBhE,MAAU+D,QAAQ/D,MAClBC,MAAU8D,QAAQ9D,WAKnBgE","file":"dfbm-admin.min.js","sourcesContent":["(function($){\n\t$(function(){\n\t\"use strict\";\n\n\t\tvar dfbmAdmin = function( $opt )\n\t\t{\n\n\t\t\tthis.init( $opt );\n\n\t\t};\n\n\t\t$.extend( dfbmAdmin.prototype,\n\t\t{\n\n\t\t\tinit : function( $opt )\n\t\t\t{\n\n\t\t\t\tthis.vars( $opt );\n\n\t\t\t\tthis.load();\n\n\t\t\t}, // end init\n\n\t\t\tvars : function( $opt )\n\t\t\t{\n\n\t\t\t\tthis.opt = $.extend( {},\n\t\t\t\t{\n\n\t\t\t\t\tprefix  : 'et_pb_templates_',\n\t\t\t\t\tprfix   : '',\n\t\t\t\t\tnewVers : '',\n\t\t\t\t\terror   : '',\n\t\t\t\t\tslugs   : '',\n\n\t\t\t\t}, $opt );\n\n\t\t\t\tthis.prfix   = new RegExp( this.opt.prfix );\n\n\t\t\t\tthis.newVers = parseInt( this.opt.newVers );\n\n\t\t\t}, // end vars\n\n\t\t\tload : function()\n\t\t\t{\n\n\t\t\t\tvar $this = this, checkStorage = setInterval( function()\n\t\t\t\t{\n\n\t\t\t\t\tif ( 'string' == typeof localStorage.et_pb_templates_settings_product_version )\n\t\t\t\t\t{\n\n\t\t\t\t\t\tclearInterval( checkStorage );\n\n\t\t\t\t\t\tsetTimeout( function()\n\t\t\t\t\t\t{\n\n\t\t\t\t\t\t\tif ( $this.newVers )\n\t\t\t\t\t\t\t\t$this.rebuild( false );\n\n\t\t\t\t\t\t\telse $this.check();\n\n\t\t\t\t\t\t}, 1000 );\n\t\t\t\t\t}\n\t\t\t\t}, 300 );\n\t\t\t}, // end load\n\n\t\t\tcheck : function()\n\t\t\t{\n\n\t\t\t\tif ( ! this.local() )\n\t\t\t\t\treturn;\n\n\t\t\t\tvar item, temp, mods = [];\n\n\t\t\t\tfor ( item in localStorage )\n\t\t\t\t{\n\n\t\t\t\t\tif ( -1 !== item.indexOf( this.prfix ) )\n\t\t\t\t\t{\n\n\t\t\t\t\t\tmods.push( item );\n\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( mods.length != this.opt.slugs.length )\n\t\t\t\t\tthis.rebuild( true, mods );\n\n\t\t\t}, // end check\n\n\t\t\tlocal : function()\n\t\t\t{\n\n\t\t\t\treturn 'localStorage' in window && window.localStorage !== null;\n\n\t\t\t},\n\n\t\t\trebuild : function( clear, mods )\n\t\t\t{\n\n\t\t\t\tvar $this = this,\n\t\t\t\t\tmods  = mods || false,\n\t\t\t\t\tpref  = 'et_pb_templates_';\n\n\t\t\t\tif ( ! clear )\n\t\t\t\t\tthis.clear();\n\n\t\t\t\tif ( mods )\n\t\t\t\t\tvar get = this.opt.slugs.filter( function( item )\n\t\t\t\t\t{\n\n\t\t\t\t\t\treturn mods.indexOf( pref + item ) < 0\n\n\t\t\t\t\t});\n\n\t\t\t\telse\n\t\t\t\t\tget = this.opt.slugs;\n\n\t\t\t\t$.ajax(\n\t\t\t\t{\n\n\t\t\t\t\ttype     : 'post',\n\t\t\t\t\tdataType : 'json',\n\t\t\t\t\turl      : et_pb_options.ajaxurl,\n\t\t\t\t\tdata:\n\t\t\t\t\t{\n\n\t\t\t\t\t\taction              : 'et_pb_get_backbone_template',\n\t\t\t\t\t\tet_post_type        : et_pb_options.post_type,\n\t\t\t\t\t\tet_admin_load_nonce : et_pb_options.et_admin_load_nonce,\n\t\t\t\t\t\tet_modules_slugs    : JSON.stringify({ missing_modules_array: get }),\n\n\t\t\t\t\t},\n\t\t\t\t\tsuccess: function( data )\n\t\t\t\t\t{\n\n\t\t\t\t\t\tif ( 'undefined' != typeof data.templates && data.templates.length > 0 )\n\t\t\t\t\t\t{\n\n\t\t\t\t\t\t\t$.each( data.templates, function( i, item )\n\t\t\t\t\t\t\t{\n\n\t\t\t\t\t\t\t\tvar template = $this.template( item['template'], data.unique );\n\n\t\t\t\t\t\t\t\tif ( $this.local() )\n\t\t\t\t\t\t\t\t{\n\n\t\t\t\t\t\t\t\t\ttry\n\t\t\t\t\t\t\t\t\t{\n\n\t\t\t\t\t\t\t\t\t\tlocalStorage.setItem( pref + item['slug'], LZString.compressToUTF16( template ) );\n\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tcatch(e)\n\t\t\t\t\t\t\t\t\t{\n\n\t\t\t\t\t\t\t\t\t\t// nothing needs to happen here\n\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t$( '#et-builder-' + item['slug'] + '-module-template' ).remove();\n\n\t\t\t\t\t\t\t\t$( 'body' ).append( template );\n\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} // end if\n\t\t\t\t\t},\n\n\t\t\t\t\terror: function( r )\n\t\t\t\t\t{\n\n\t\t\t\t\t\tconsole.log( r );\n\n\t\t\t        }\n\t\t\t\t});\n\t\t\t}, // end rebuild\n\n\t\t\ttemplate : function( template, map )\n\t\t\t{\n\n\t\t\t\tif ( 'undefined' == typeof map )\n\t\t\t\t\treturn template;\n\n\t\t\t\tvar str = /<!-- (\\d+) -->/g;\n\n\t\t\t\treturn template.replace( str, function( match, key )\n\t\t\t\t{\n\n\t\t\t\t\treturn map[key];\n\n\t\t\t\t} );\n\t\t\t},\n\n\t\t\tclear : function()\n\t\t\t{\n\n\t\t\t\tfor ( var item in localStorage )\n\t\t\t\t{\n\n\t\t\t\t\tif ( -1 !== item.indexOf( this.prfix ) )\n\t\t\t\t\t\tlocalStorage.removeItem( item );\n\n\t\t\t\t}\n\t\t\t}, // end clear\n\n\t\t\terror : function()\n\t\t\t{\n\n\t\t\t\tthis.clear();\n\n\t\t\t\talert( this.opt.error );\n\n\t\t\t}, // end error\n\n\t\t\tlocal : function()\n\t\t\t{\n\n\t\t\t\treturn 'localStorage' in window && window.localStorage !== null;\n\n\t\t\t}, // end local\n\t\t}); // end dfbmAdmin\n\n\t\tnew dfbmAdmin(\n\t\t{\n\n\t\t\tprfix   : dfbmPHP.prfix,\n\t\t\tnewVers : dfbmPHP.new,\n\t\t\terror   : dfbmPHP.error,\n\t\t\tslugs   : dfbmPHP.slugs,\n\n\t\t});\n\n\t});\n}(jQuery));\n"]}